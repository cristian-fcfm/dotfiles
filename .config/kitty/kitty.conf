# vim:fileencoding=utf-8:foldmethod=marker

# ========================================
# TEMA
# ========================================
# Tokyo Night - Puedes cambiar el archivo de tema
include current-theme.conf

# ========================================
# FUENTES
# ========================================
# Fuente principal con soporte para iconos
font_family        JetBrainsMono Nerd Font
bold_font          auto
italic_font        auto
bold_italic_font   auto
# Tamaño de fuente en puntos
font_size          10.0

# Activar ligaduras de programación
enable_ligatures   yes

# Features tipográficas avanzadas
font_features      JetBrainsMono Nerd Font +zero +calt +ss01 +ss02 +cv01 +cv02 +cv03 +cv04 +cv05 +cv06 +frac +subs +sups +sinf

# Fuente para emojis
symbol_map U+1F300-U+1F6FF Noto Color Emoji

# ========================================
# CURSOR
# ========================================
# Color del cursor
cursor #ffffff
cursor_text_color background
# Forma: beam (|), block (█), underline (_)
cursor_shape beam
cursor_shape_unfocused hollow
cursor_beam_thickness 1.5
# 0 = no parpadea
cursor_blink_interval 0
cursor_stop_blinking_after 0
cursor_trail 0

# ========================================
# SCROLLBACK
# ========================================
# Líneas de historial (10k para data science)
scrollback_lines 10000
scrollback_indicator_opacity 0.7
scrollback_pager less --chop-long-lines --RAW-CONTROL-CHARS +INPUT_LINE_NUMBER
scrollback_pager_history_size 10
scrollback_fill_enlarged_window no
wheel_scroll_multiplier 3.0
wheel_scroll_min_lines 1
touch_scroll_multiplier 1.0

# ========================================
# MOUSE
# ========================================
# -1 = nunca ocultar cursor
mouse_hide_wait -1.0
url_color #0087bd
url_style curly
open_url_with default
url_prefixes file ftp ftps gemini git gopher http https irc ircs kitty mailto news sftp ssh
detect_urls yes
show_hyperlink_targets yes
underline_hyperlinks hover

# Importante para copiar resultados en data science
copy_on_select yes
clear_selection_on_clipboard_loss no
paste_actions quote-urls-at-prompt,confirm
# smart = solo líneas modificadas
strip_trailing_spaces smart

# Caracteres que forman una palabra
select_by_word_characters @-./_~?&=%+#
select_by_word_characters_forward
click_interval -1.0
focus_follows_mouse no
pointer_shape_when_grabbed arrow
default_pointer_shape beam
pointer_shape_when_dragging beam

# ========================================
# PERFORMANCE
# ========================================
input_delay 3
sync_to_monitor yes

# ========================================
# CONFIGURACIÓN CRÍTICA PARA VIM-SLIME
# ========================================
# Sin esto vim-slime NO funcionará
allow_remote_control yes
# Socket para comunicación
listen_on unix:/tmp/kitty

# Integración con clipboard
clipboard_control write-clipboard write-primary read-clipboard read-primary

# ========================================
# VENTANAS
# ========================================
remember_window_size  yes
initial_window_width  1200
initial_window_height 800

# Layouts disponibles
enabled_layouts tall:bias=70;full_size=1;mirrored=false,fat:bias=70;full_size=1;mirrored=false,horizontal,vertical,grid,stack

window_resize_step_cells 2
window_resize_step_lines 2
window_border_width 1pt
draw_minimal_borders yes
window_margin_width 0
single_window_margin_width -1
window_padding_width 5
placement_strategy center

# Colores de bordes
active_border_color #7aa2f7
inactive_border_color #3b4252
bell_border_color #ff9e64

inactive_text_alpha 0.7
hide_window_decorations no
window_logo_path none
window_logo_position bottom-right
window_logo_alpha 0.5
resize_debounce_time 0.1 0.5
resize_in_steps no
visual_window_select_characters 1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ
confirm_os_window_close 0

# ========================================
# TABS
# ========================================
tab_bar_edge top
tab_bar_margin_width 0.0
tab_bar_margin_height 3.0 0.0
tab_bar_style powerline
tab_bar_align left
tab_bar_min_tabs 2
tab_switch_strategy previous
tab_fade 0.25 0.5 0.75 1
tab_separator " ┇"
tab_powerline_style slanted
tab_activity_symbol 
tab_title_max_length 20
tab_title_template "{fmt.fg.red}{bell_symbol}{activity_symbol}{fmt.fg.tab}{title}"
active_tab_title_template "{fmt.fg.red}{bell_symbol}{activity_symbol}{fmt.fg.tab}{title}"

# Colores de tabs
active_tab_foreground   #1a1b26
active_tab_background   #7aa2f7
inactive_tab_foreground #a9b1d6
inactive_tab_background #3b4252
tab_bar_background #1a1b26
tab_bar_margin_color none

# ========================================
# COLORES DE MARCAS
# ========================================
mark1_foreground black
mark1_background #98d3cb
mark2_foreground black
mark2_background #f2dcd3
mark3_foreground black
mark3_background #f274bc

# ========================================
# CONFIGURACIÓN AVANZADA
# ========================================
# Usar shell por defecto
shell .
editor nvim
close_on_child_death no
remote_kitty if-needed
update_check_interval 24
startup_session none
clipboard_max_size 512
allow_hyperlinks yes
shell_integration enabled
allow_cloning ask
clone_source_strategies venv,conda,env_var,path
notify_on_cmd_finish never
# NO incluir 'term' - dejar que Kitty use el default
forward_stdio no

# ========================================
# ATAJOS DE TECLADO
# ========================================
# Limpiar atajos por defecto
clear_all_shortcuts yes

# Clipboard
map ctrl+shift+c copy_to_clipboard
map ctrl+shift+v paste_from_clipboard

# Scrolling
map ctrl+shift+up scroll_line_up
map ctrl+shift+down scroll_line_down
map ctrl+shift+page_up scroll_page_up
map ctrl+shift+page_down scroll_page_down
map ctrl+shift+home scroll_home
map ctrl+shift+end scroll_end
map ctrl+shift+h show_scrollback
map ctrl+shift+g show_last_command_output

# Gestión de ventanas
map ctrl+shift+enter launch --cwd=current
map ctrl+shift+n new_os_window
map ctrl+shift+w close_window
map ctrl+shift+] next_window
map ctrl+shift+[ previous_window
map ctrl+shift+f move_window_forward
map ctrl+shift+b move_window_backward
map ctrl+shift+` move_window_to_top
map ctrl+shift+r start_resizing_window

# Ventanas numeradas
map ctrl+shift+1 first_window
map ctrl+shift+2 second_window
map ctrl+shift+3 third_window
map ctrl+shift+4 fourth_window
map ctrl+shift+5 fifth_window
map ctrl+shift+6 sixth_window
map ctrl+shift+7 seventh_window
map ctrl+shift+8 eighth_window
map ctrl+shift+9 ninth_window
map ctrl+shift+0 tenth_window

# Navegación estilo Vim
map ctrl+shift+h neighboring_window left
map ctrl+shift+l neighboring_window right
map ctrl+shift+k neighboring_window up
map ctrl+shift+j neighboring_window down

# Data Science: IPython
map ctrl+shift+i launch --location=vsplit --cwd=current ipython --no-autoindent --matplotlib
map ctrl+shift+p launch --location=hsplit --cwd=current ipython --no-autoindent --matplotlib
# Terminal normal (cambiado de ctrl+shift+t para evitar conflicto con new_tab)
map ctrl+shift+o launch --location=vsplit --cwd=current

# Layouts
map ctrl+shift+z toggle_layout stack
map ctrl+alt+t goto_layout tall
map ctrl+alt+s goto_layout stack
map ctrl+alt+p goto_layout horizontal
map ctrl+alt+v goto_layout vertical
map ctrl+alt+g goto_layout grid
map ctrl+alt+f goto_layout fat

# Tabs
map ctrl+shift+t new_tab
map ctrl+shift+q close_tab
map ctrl+shift+right next_tab
map ctrl+shift+left previous_tab
map ctrl+shift+. move_tab_forward
map ctrl+shift+, move_tab_backward
map ctrl+alt+t set_tab_title

# Tamaño de fuente
map ctrl+shift+equal change_font_size all +1.0
map ctrl+shift+plus change_font_size all +1.0
map ctrl+shift+minus change_font_size all -1.0
map ctrl+shift+backspace change_font_size all 0

# Funciones especiales
map ctrl+shift+f11 toggle_fullscreen
map ctrl+shift+f10 toggle_maximized
map ctrl+shift+u kitten unicode_input
map ctrl+shift+f2 edit_config_file
map ctrl+shift+escape kitty_shell window
map ctrl+shift+delete clear_terminal reset active
map ctrl+shift+f5 load_config_file
map ctrl+shift+f6 debug_config

# Transparencia
map ctrl+shift+a>m set_background_opacity +0.1
map ctrl+shift+a>l set_background_opacity -0.1
map ctrl+shift+a>1 set_background_opacity 1
map ctrl+shift+a>d set_background_opacity default
