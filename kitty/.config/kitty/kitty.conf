# vim:fileencoding=utf-8:foldmethod=marker

# ========================================
# TEMA
# ========================================
include Kanagawa_dragon.conf

# ========================================
# FUENTES
# ========================================
# Fuente principal con soporte para iconos
font_family        FiraCode Nerd Font
bold_font          auto
italic_font        auto
bold_italic_font   auto
# Tamaño de fuente en puntos
font_size          12.0

# Activar ligaduras de programación
enable_ligatures   yes

# Features tipográficas avanzadas
font_features      FiraCode Nerd Font +zero +calt +ss01 +ss02 +cv01 +cv02 +cv03 +cv04 +cv05 +cv06 +frac +subs +sups +sinf

# Fuente para emojis
# symbol_map U+1F300-U+1F6FF Noto Color Emoji
symbol_map U+1F300-U+1F6FF Apple Color Emoji

# ========================================
# CURSOR
# ========================================
# Color del cursor
# cursor #ffffff
# cursor_text_color background
# Forma: beam (|), block (█), underline (_)
cursor_shape beam
cursor_shape_unfocused hollow
cursor_beam_thickness 1.5
# 0 = no parpadea
cursor_blink_interval 0
cursor_stop_blinking_after 0
cursor_trail 0

# ========================================
# SCROLLBACK
# ========================================
# Líneas de historial (10k para data science)
scrollback_lines 10000
scrollback_indicator_opacity 0.7
scrollback_pager less --chop-long-lines --RAW-CONTROL-CHARS +INPUT_LINE_NUMBER
scrollback_pager_history_size 10
scrollback_fill_enlarged_window no
wheel_scroll_multiplier 3.0
wheel_scroll_min_lines 1
touch_scroll_multiplier 1.0

# ========================================
# MOUSE
# ========================================
# -1 = nunca ocultar cursor
mouse_hide_wait -1.0
# url_color #0087bd
url_style curly
open_url_with default
url_prefixes file ftp ftps gemini git gopher http https irc ircs kitty mailto news sftp ssh
detect_urls yes
show_hyperlink_targets yes
underline_hyperlinks hover

# Importante para copiar resultados en data science
copy_on_select yes
clear_selection_on_clipboard_loss no
paste_actions quote-urls-at-prompt,confirm
# smart = solo líneas modificadas
strip_trailing_spaces smart

# Caracteres que forman una palabra
select_by_word_characters @-./_~?&=%+#
select_by_word_characters_forward
click_interval -1.0
focus_follows_mouse no
pointer_shape_when_grabbed arrow
default_pointer_shape beam
pointer_shape_when_dragging beam

# ========================================
# PERFORMANCE
# ========================================
input_delay 3
sync_to_monitor yes

# ========================================
# VENTANAS - CONFIGURACIÓN COMPLETA"{index}  {tab.active_wd.rsplit('/', 1)[-1]}"
# ========================================
remember_window_size  yes
initial_window_width  1200
initial_window_height 800

# Layouts disponibles (usar kitty)
enabled_layouts tall, *

window_resize_step_cells 2
window_resize_step_lines 2
window_border_width 1pt
draw_minimal_borders yes
window_margin_width 0
single_window_margin_width -1
window_padding_width 5
placement_strategy center

inactive_text_alpha 0.7
hide_window_decorations no
resize_debounce_time 0.1 0.5
resize_in_steps no
visual_window_select_characters 1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ
confirm_os_window_close 0

# ========================================
# TABS - CONFIGURACIÓN COMPLETA
# ========================================
tab_bar_edge            top
tab_bar_min_tabs        1
tab_bar_margin_height   0 0
tab_bar_margin_width    10
tab_bar_background      #232634
tab_title_template "{fmt.noitalic}{fmt.fg.tab}{index}  {tab.active_oldest_exe}{activity_symbol}{fmt.fg.red}{bell_symbol}"
active_tab_title_template "{fmt.noitalic}{fmt.fg.tab}{index}  {tab.active_oldest_exe}{activity_symbol}{fmt.fg.red}{bell_symbol}"
tab_bar_style custom
tab_separator ""

# ========================================
# TRANSPARENCIA Y BLUR
# ========================================
background_opacity 1.0
dynamic_background_opacity yes

# ========================================
# AUDIO Y NOTIFICACIONES
# ========================================
enable_audio_bell no
visual_bell_duration 0.0
window_alert_on_bell yes
bell_on_tab " "

# ========================================
# CONFIGURACIÓN ESPECÍFICA POR OS
# ========================================
# macOS
macos_option_as_alt left
macos_quit_when_last_window_closed yes
macos_thicken_font 0.15
macos_traditional_fullscreen no
macos_show_window_title_in none
hide_window_decorations titlebar-only

# Linux (Arch - Wayland/X11)
linux_display_server auto

# ========================================
# PERFORMANCE Y RENDERING
# ========================================
repaint_delay 10

# ========================================
# CONFIGURACIÓN AVANZADA
# ========================================
# Usar shell por defecto
shell zsh
editor nvim
close_on_child_death no
update_check_interval 24
clipboard_max_size 512
allow_hyperlinks yes
shell_integration enabled
notify_on_cmd_finish never
forward_stdio no

# ========================================
# VIM-SLIME INTEGRATION
# ========================================
# Habilitar control remoto para vim-slime
allow_remote_control yes
# Socket de comunicación con nvim slime
listen_on unix:/tmp/mykitty

# ========================================
# ATAJOS DE TECLADO - REEMPLAZO DE TMUX
# ========================================
# Limpiar atajos por defecto
clear_all_shortcuts yes

# ========================================
# CLIPBOARD
# ========================================
map ctrl+shift+c copy_to_clipboard
map ctrl+shift+v paste_from_clipboard

# ========================================
# SCROLLING
# ========================================
map ctrl+shift+up scroll_line_up
map ctrl+shift+down scroll_line_down
map ctrl+shift+page_up scroll_page_up
map ctrl+shift+page_down scroll_page_down
map ctrl+shift+home scroll_home
map ctrl+shift+end scroll_end
map ctrl+shift+h show_scrollback
map ctrl+shift+g show_last_command_output

# ========================================
# TABS
# ========================================
# Crear y cerrar tabs
map ctrl+shift+t new_tab
map ctrl+shift+q close_tab
map ctrl+alt+t new_tab_with_cwd

# Navegar entre tabs
map ctrl+shift+right next_tab
map ctrl+shift+left previous_tab
map ctrl+alt+right move_tab_forward
map ctrl+alt+left move_tab_backward

# Ir a tab específico
map ctrl+shift+1 goto_tab 1
map ctrl+shift+2 goto_tab 2
map ctrl+shift+3 goto_tab 3
map ctrl+shift+4 goto_tab 4
map ctrl+shift+5 goto_tab 5
map ctrl+shift+6 goto_tab 6
map ctrl+shift+7 goto_tab 7
map ctrl+shift+8 goto_tab 8
map ctrl+shift+9 goto_tab 9

# Renombrar tab
map ctrl+shift+r set_tab_title

# Cambiar de layouts
map ctrl+shift+z toggle_layout stack
map ctrl+shift+s goto_layout splits
map ctrl+shift+space next_layout

# ========================================
# WINDOWS/SPLITS (equivalente a tmux panes)
# ========================================
# Crear splits (windows)
map ctrl+shift+enter new_window_with_cwd
map ctrl+shift+\ launch --location=vsplit --cwd=current
map ctrl+shift+- launch --location=hsplit --cwd=current
map ctrl+alt+n new_os_window

# Cerrar window
map ctrl+shift+w close_window

# Navegar entre windows
map ctrl+shift+n next_window
map ctrl+shift+p previous_window
map ctrl+shift+. move_window_forward
map ctrl+shift+, move_window_backward

# Navegar con hjkl (estilo vim)
map ctrl+shift+h neighboring_window left
map ctrl+shift+l neighboring_window right
map ctrl+shift+k neighboring_window up
map ctrl+shift+j neighboring_window down

# Mover windows con hjkl
map ctrl+shift+alt+h move_window left
map ctrl+shift+alt+l move_window right
map ctrl+shift+alt+k move_window up
map ctrl+shift+alt+j move_window down

# Redimensionar windows
map ctrl+alt+h resize_window narrower 2
map ctrl+alt+l resize_window wider 2
map ctrl+alt+k resize_window taller 2
map ctrl+alt+j resize_window shorter 2

# Reset tamaños de windows
map ctrl+shift+= resize_window reset

# ========================================
# FUENTES
# ========================================
map ctrl+shift+equal change_font_size all +1.0
map ctrl+shift+plus change_font_size all +1.0
map ctrl+shift+kp_add change_font_size all +1.0
map ctrl+shift+minus change_font_size all -1.0
map ctrl+shift+kp_subtract change_font_size all -1.0
map ctrl+shift+backspace change_font_size all 0

# ========================================
# FUNCIONES ESPECIALES
# ========================================
map ctrl+shift+f11 toggle_fullscreen
map ctrl+shift+f10 toggle_maximized
map ctrl+shift+u kitten unicode_input
map ctrl+shift+f2 edit_config_file
map ctrl+shift+escape kitty_shell window
map ctrl+shift+delete clear_terminal reset active
map ctrl+shift+f5 load_config_file
map ctrl+shift+f6 debug_config

# ========================================
# TRANSPARENCIA
# ========================================
map ctrl+shift+a>m set_background_opacity +0.1
map ctrl+shift+a>l set_background_opacity -0.1
map ctrl+shift+a>1 set_background_opacity 1
map ctrl+shift+a>d set_background_opacity default

# ========================================
# BÚSQUEDA
# ========================================
map ctrl+shift+f show_scrollback
map ctrl+shift+/ launch --type=overlay --stdin-source=@screen_scrollback fzf --no-sort --no-mouse --exact -i
